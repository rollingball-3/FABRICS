# Parameters for CS63 robot with Tesollo (DG3F) gripper - Gripper Attractor variant
#
# This variant replaces force-based fingertip control with a gripper attractor in a
# compressed (synergy / PCA-like) task space.
#
# Notes:
# - Palm attractor is preserved (arm control stays in Fabrics).
# - Gripper attractor acts only on the last 12 joints (F1M1..F3M4) via a LinearMap.
# - Joint limits / energy / collision avoidance can be enabled as needed.
#
# English comments in code; this YAML is configuration.

fabric_params:
    active_flags:
        cspace_attractor: True
        joint_limit_repulsion: True
        # Enable the gripper attractor in latent (compressed) space.
        gripper_attractor: True
        palm_attractor: True
        body_repulsion: False
        cspace_energy: True

    cspace_attractor:
        min_isotropic_mass: 1.0
        max_isotropic_mass: 1.0
        mass_sharpness: 20.0
        mass_switch_offset: 1.0
        conical_sharpness: 20.0
        conical_gain: 1.0

    joint_limit_repulsion:
        velocity_gate: True
        breakaway_distance: 0.0
        breakaway_velocity: 0.0
        soft_relu_gain: 8.0
        metric_scalar: 0.02
        metric_exploder_offset: 0.1
        max_metric: 100.0
        damping_gain: 8.0

    # Gripper attractor in latent space (k-dim). Similar to kuka_allegro_pose hand_attractor.
    gripper_attractor:
        min_isotropic_mass: 8.0
        max_isotropic_mass: 8.0
        mass_sharpness: 20.0
        mass_switch_offset: 0.5
        conical_sharpness: 40.0
        conical_gain: 50.0
        damping: 50.0
        damping_sharpness: 10.0
        damping_radius: 0.2

    palm_attractor:
        min_isotropic_mass: 5.0
        max_isotropic_mass: 5.0
        mass_sharpness: 10.0
        mass_switch_offset: 0.5
        conical_sharpness: 40.0
        conical_gain: 50.0
        damping: 50.0
        damping_sharpness: 10.0
        damping_radius: 0.05

    body_repulsion:
      max_depth: 2.0
      min_depth: 0.01
      engage_depth: 0.5
      breakaway_depth: 0.0
      breakaway_velocity: 0.0
      metric_scalar: 1.0
      velocity_gate: True
      velocity_gate_sharpness: 1000.0
      velocity_gate_offset: 0.002
      rescaled_min_dist: 0.01
      forcing_metric_scalar: 0.01
      geom_metric_scalar: 0.01
      constant_accel: 1.0
      constant_accel_geom: 5.0
      damping_gain: 0.0
      # Keep collision config identical to cs63_tesollo_params.yaml when enabling.
      collision_sphere_frames: []
      collision_sphere_radii: []
      collision_sphere_pairs: []
      collision_link_prefix_pairs: []

    cspace_damping:
      gain: 5.0

    speed_control:
      active: False
      energy_target: 10.0
      damping: 100.0

    joint_limits:
      active: True
      acceleration: [
          7.5, 7.5, 10.0, 10.0, 10.0, 20.0,
          22.5, 22.5, 22.5, 22.5,
          22.5, 22.5, 22.5, 22.5,
          22.5, 22.5, 22.5, 22.5
      ]
      jerk: [
          3750.0, 3750.0, 5000.0, 5000.0, 5000.0, 10000.0,
          2250.0, 2250.0, 2250.0, 2250.0,
          2250.0, 2250.0, 2250.0, 2250.0,
          2250.0, 2250.0, 2250.0, 2250.0
      ]
